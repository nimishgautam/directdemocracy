;(function(undefined){
    'use strict';

    this.Registry = {
        ApiEndpoint: '/ddapi'
    };

    this.Views = {
        Pages: {}
    };

    this.Collections = {};
    this.Models = {};

}).call(this);;this["Templates"] = this["Templates"] || {};

this["Templates"]["comment-partial"] = new Hogan.Template(function(c,p,i){var _=this;_.b(i=i||"");_.b("<article id=\"comment-");_.b(_.v(_.f("id",c,p,0)));_.b("\">");_.b("\n" + i);_.b("	<header class=\"vcard\">");_.b("\n" + i);_.b("		<span class=\"fn\">");_.b(_.v(_.f("fullname",c,p,0)));_.b("</span>");_.b("\n" + i);_.b("		<time pubdate>");_.b(_.v(_.f("date",c,p,0)));_.b("</time>");_.b("\n" + i);_.b("	</header>");_.b("\n" + i);_.b("	<p class=\"comment-body\">");_.b("\n" + i);_.b("		");_.b(_.v(_.f("comment",c,p,0)));_.b("\n" + i);_.b("	</p>");_.b("\n" + i);_.b("</article>");return _.fl();;});

this["Templates"]["front-page"] = new Hogan.Template(function(c,p,i){var _=this;_.b(i=i||"");return _.fl();;});

this["Templates"]["issue-page"] = new Hogan.Template(function(c,p,i){var _=this;_.b(i=i||"");if(_.s(_.f("name",c,p,1),c,p,0,9,935,"{{ }}")){_.rs(c,p,function(c,p,_){_.b("<section class=\"issue\">");_.b("\n" + i);_.b("	<article class=\"issue-content\">");_.b("\n" + i);_.b("		<header>");_.b("\n" + i);_.b("			<h1>");_.b(_.v(_.f("name",c,p,0)));_.b("</h1>");_.b("\n" + i);_.b("			<div class=\"positive-votes\">");_.b(_.v(_.f("positivePercentage",c,p,0)));_.b(" %</div>");_.b("\n" + i);_.b("			<div class=\"negative-votes\">");_.b(_.v(_.f("negativePercentage",c,p,0)));_.b(" %</div>");_.b("\n" + i);_.b("		</header>");_.b("\n" + i);_.b("		");_.b(_.v(_.f("text",c,p,0)));_.b("\n" + i);_.b("		<button class=\"large positive\">God idé!</button>");_.b("\n" + i);_.b("		<button class=\"large negative\">Dårlig idé!</button>");_.b("\n" + i);_.b("		<h2 class=\"text-center divider\">Artikler og kilde om emnet</h2>");_.b("\n" + i);if(_.s(_.f("links",c,p,1),c,p,0,429,455,"{{ }}")){_.rs(c,p,function(c,p,_){_.b(_.rp("link-partial",c,p,"			"));});c.pop();}if(!_.s(_.f("links",c,p,1),c,p,1,0,0,"")){_.b("			Loading");_.b("\n");};_.b("	</article>");_.b("\n" + i);_.b("	<section class=\"issue-progress\">");_.b("\n" + i);_.b("		<h1>");_.b(_.v(_.f("progressPercentage",c,p,0)));_.b(" %</h1>");_.b("\n" + i);_.b("		<h2>");_.b("\n" + i);_.b("			");_.b(_.v(_.f("votes",c,p,0)));_.b(" har stemt <br>");_.b("\n" + i);_.b("			");_.b(_.v(_.f("votesGoal",c,p,0)));_.b(" er m&aring;let");_.b("\n" + i);_.b("		</h2>");_.b("\n" + i);_.b("	</section>");_.b("\n" + i);_.b("	<aside class=\"issue-details\">");_.b("\n" + i);_.b("		<img src=\"");_.b(_.v(_.d("author.avatar",c,p,0)));_.b("\" alt=\"");_.b(_.v(_.d("author.name",c,p,0)));_.b("\" />");_.b("\n" + i);_.b("		<h1>");_.b(_.v(_.d("author.name",c,p,0)));_.b("</h1>");_.b("\n" + i);_.b("		<p>");_.b(_.v(_.d("author.bio",c,p,0)));_.b("</p>");_.b("\n" + i);_.b("	</aside>");_.b("\n" + i);_.b("	<section class=\"comments\">");_.b("\n" + i);if(_.s(_.f("comments",c,p,1),c,p,0,869,898,"{{ }}")){_.rs(c,p,function(c,p,_){_.b(_.rp("comment-partial",c,p,"			"));});c.pop();}_.b("	</section>");_.b("\n" + i);_.b("</section>");_.b("\n");});c.pop();}if(!_.s(_.f("name",c,p,1),c,p,1,0,0,"")){_.b("Loading");_.b("\n");};return _.fl();;});

this["Templates"]["link-partial"] = new Hogan.Template(function(c,p,i){var _=this;_.b(i=i||"");_.b("<article class=\"link\">");_.b("\n" + i);_.b("	<div class=\"controls\">");_.b("\n" + i);_.b("		<a href=\"#up\" class=\"up-vote\">Stem op</a>");_.b("\n" + i);_.b("		<span class=\"counter\">");_.b(_.v(_.f("totalVotes",c,p,0)));_.b("</span>");_.b("\n" + i);_.b("		<a href=\"#down\" class=\"down-vote\">Stem ned</a>");_.b("\n" + i);_.b("	</div>");_.b("\n" + i);_.b("</article>");return _.fl();;});;;(function(undefined){
    'use strict';

    this.Models.Issue = Backbone.Model.extend({
        urlRoot: Registry.ApiEndpoint + '/issues',
    });

}).call(this);;;(function(undefined){
    'use strict';

    this.Models.relatedLink = Backbone.Model.extend({});

}).call(this);;;(function(undefined){
    'use strict';

    this.Collections.Issues = Backbone.Collection.extend({
        url: Registry.ApiEndpoint + '/issues',
        model: Models.Issue
    });

}).call(this);;;(function(undefined){
    'use strict';

    this.Collections.relatedLinks = Backbone.Collection.extend({
        url: Registry.ApiEndpoint + '/relatedlinks',
        model: Models.relatedLinks
    });

}).call(this);;;(function(undefined){
    'use strict';

    this.Views.Issue = Backbone.View.extend({
        template: Templates['issue-page'],

        initialize: function() {
            this.listenTo(this.model, 'change', this.render.bind(this));
        },
    
        render: function() {
            this.$el.html(
                this.template.render(this.model.toJSON(), {
                    'comment-partial': Templates['comment-partial']
                })
            );
    
            return this.trigger('render');
        }
    });

}).call(this);;;(function(undefined){
    'use strict';

    var changePage = function(PageClass) {
        var p = new PageClass({ 
            el: $('main').first(),
            model: new Models.Test() 
        })
        .render();
    };

    this.AppRouter = Backbone.Router.extend({
        routes: {
            '':                 'indexAction',
            'issue/:id':       'issueAction'
        },

        indexAction: function() {
            alert('splat');
        },

        issueAction: function(id) {
            var m = new Models.Issue({id: id});
            var p = new Views.Issue({
                el: $('main').first(),
                model: m
            });

            m.fetch();
            p.render();
        }
    });

}).call(this);